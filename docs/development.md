# 開発ガイド

このドキュメントは `mkdocs-mermaid-to-image` プラグインの開発に参加するための総合的なガイドです。

## 前提条件

開発を始める前に、以下のツールがシステムにインストールされていることを確認してください。

- **Python**: 3.9 以上
- **Node.js**: 16.0.0 以上
- **npm**: 7.0.0 以上
- **uv**: 高速なPythonパッケージインストーラー
- **Make**: ビルド自動化ツール

## セットアップ

開発環境のセットアップは、リポジトリのルートで以下のコマンドを実行するだけです。

```bash
make setup
```

このコマンドは、Pythonの依存関係とNode.jsの依存関係をインストールし、pre-commitフックを設定します。

## ローカルでのビルドとインストール

開発中にプラグインの動作を確認するには、ローカルでビルドしてインストールする必要があります。
ソースコードの変更を即座に反映させるために、編集可能モード (`-e`) でインストールすることを推奨します。

```bash
make install-dev
```

これにより、`mkdocs.yml` で `mermaid-to-image` プラグインを指定したMkDocsプロジェクトで、開発中のプラグインを直接テストできます。

## よく使うコマンド

`Makefile` には、開発を効率化するためのコマンドが多数定義されています。

- `make install-dev`: 開発用に編集可能モードでパッケージをインストールします。
- `make test`: すべてのテストを実行します。
- `make test-cov`: カバレッジレポート付きでテストを実行します。
- `make check`: フォーマット、リント、型チェック、テストを順番に実行します。
- `make check-all`: pre-commitを使って、すべてのファイルに対して品質チェックを実行します。
- `uv run mkdocs serve`: 開発用のローカルサーバーを起動します。
- `uv run mkdocs build`: ドキュメントサイトをビルドします。
- `ENABLE_PDF_EXPORT=1 uv run mkdocs build`: PDF生成を有効にしてドキュメントサイトをビルドします。
- `mmdc --version`: ローカルインストールされたMermaid CLIのバージョン確認。
- `npx mmdc --version`: npx経由でのMermaid CLIのバージョン確認（フォールバック）。

利用可能なすべてのコマンドについては、`make help` を実行して確認してください。
